Public Task As String

Function UserNames() As String
    Dim Users As Variant
    Dim sMsg As String
    Dim iIndex As Integer

    Users = ActiveWorkbook.UserStatus

    For iIndex = 1 To UBound(Users, 1)
        sMsg = Users(iIndex, 1) & vbLf
    Next iIndex
    'remove final line feed
    sMsg = Left(sMsg, Len(sMsg) - 1)

    UserNames = sMsg
End Function
Sub Lidar_Block1_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "B").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "B").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("B4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block2_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "C").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "C").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("C4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block3_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "D").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "D").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("D4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block4_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "E").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "E").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("E4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block5_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "F").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "F").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("F4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block6_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "G").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "G").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("G4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block7_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "H").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "H").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("H4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block8_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "I").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "I").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("I4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block9_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "J").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "J").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("J4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Lidar_Block10_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "K").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "K").Value = UserNames + "; " + t
Task = Range("A2").Value & " " & Range("K4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block1_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "N").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "N").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("N4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block2_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "O").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "O").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("O4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block3_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "P").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "P").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("P4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block4_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "Q").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "Q").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("Q4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block5_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "R").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "R").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("R4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block6_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "S").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "S").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("S4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block7_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "T").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "T").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("T4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block8_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "U").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "U").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("U4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block9_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "V").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "V").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("V4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub Breakline_Block10_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "W").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
Cells(n, "W").Value = UserNames + "; " + t
Task = Range("M2").Value & " " & Range("W4").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub TL_Pilot_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "Z").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
If IsEmpty(Range("Z4")) Then
    Range("Z4").Value = UserNames + "; " + t
Else
    Cells(n, "z").Value = UserNames + "; " + t
End If
Task = Range("Y2").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub TL_Review_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "AL").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
If IsEmpty(Range("AL4")) Then
    Range("AL4").Value = UserNames + "; " + t
Else
    Cells(n, "AL").Value = UserNames + "; " + t
End If
Task = Range("AK2").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub QM_Pilot_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "AX").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
If IsEmpty(Range("AX4")) Then
    Range("AX4").Value = UserNames + "; " + t
Else
    Cells(n, "AX").Value = UserNames + "; " + t
End If
Task = Range("AW2").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub QM_Review_Click()
Dim n As Long
Dim t As String
n = Cells(Rows.Count, "BJ").End(xlUp).Row + 1
t = Format(Now(), "mm/dd/yyyy hh:mm:ss")
If IsEmpty(Range("BJ4")) Then
    Range("BJ4").Value = UserNames + "; " + t
Else
    Cells(n, "BJ").Value = UserNames + "; " + t
End If
Task = Range("BI2").Value
MsgBox Task & " certified: email sent project leads."
Call RL_Email
End Sub

Sub RL_Email()
    Dim objOutlookApp As Object
    Dim objMail As Object

    On Error Resume Next
    Set objOutlookApp = CreateObject("Outlook.Application")
    Set objMail = objOutlookApp.CreateItem(olMailItem)

    With objMail
    .To = Sheets("Summary").Range("B4").Value & "; " & Sheets("Summary").Range("B6").Value & ";" & Sheets("Summary").Range("B8").Value & ";" & Sheets("Summary").Range("B11").Value & ";" & Sheets("Summary").Range("B13").Value & ";" & Sheets("Summary").Range("B15").Value
    .CC = "jmnovac@Dewberry.com" & "; " & "meanderson@Dewberry.com" & "; " & "acollins@Dewberry.com"
    .Subject = Task & " " & "Self-certification" & ": " & Sheets("Summary").Range("C18") & " -- " & Sheets("Summary").Range("C19")
    .Body = "Self-certification of" & " " & Task & " " & "has been completed for " & Sheets("Summary").Range("C18") & " -- " & Sheets("Summary").Range("C19") _
    & " " & "by" & " " & UserNames _
    & vbLf & vbLf & "Project Information: " & vbLf & vbLf & "Project Name: " & Sheets("Summary").Range("C18") & vbLf & "County Name: " _
    & Sheets("Summary").Range("C19") & vbLf & "Client: " & Sheets("Summary").Range("C20") & vbLf & "Lidar Base Specification Version: " & Sheets("Summary").Range("C21") _
    & vbLf & "Horizontal Datum/Projection: " & Sheets("Summary").Range("C22") & vbLf & "Vertical Datum: " & Sheets("Summary").Range("C23") _
    & vbLf & "Geoid: " & Sheets("Summary").Range("C24") & vbLf & "Units: " & Sheets("Summary").Range("C25") & vbLf & "Project Folder Path: " _
    & Sheets("Summary").Range("C26") & vbLf & "Swath LAS Folder: " & Sheets("Summary").Range("C27") & vbLf & "Tiled LAS Folder: " _
    & Sheets("Summary").Range("C28") & vbLf & "Final LAS Folder: " & Sheets("Summary").Range("C29") & vbLf & "Final Intensity: " & Sheets("Summary").Range("C30") _
    & vbLf & "Were the breaklines completed by a sub-contractor? " & Sheets("Summary").Range("C31") & vbLf & "Was the final Lidar classification completed by a sub-contractor? " _
    & Sheets("Summary").Range("C32")
    'Attach this workbook
    '.Attachments.Add ActiveWorkbook.FullName
    .Send
    End With
End Sub
